(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[404],{4730:function(e,t,a){Promise.resolve().then(a.bind(a,8528))},8528:function(e,t,a){"use strict";a.d(t,{default:function(){return o}});var s=a(7437),r=a(7648),n=a(2265),l=a(9376);function o(e){let{initialPosts:t,initialCategories:a,initialTags:o,initialArchives:i}=e,c=(0,l.useSearchParams)(),x=(0,l.useRouter)(),[d,m]=(0,n.useState)(""),[h,g]=(0,n.useState)(null),[u,p]=(0,n.useState)(null),[b,f]=(0,n.useState)(null),[y,w]=(0,n.useState)(!1),[j,v]=(0,n.useState)(new Set);(0,n.useEffect)(()=>{let e=c.get("category"),t=c.get("tag"),a=c.get("archive");e&&g(e),t&&p(t),a&&f(a)},[c]);let N=function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];let a=e.toLowerCase(),s=t.toLowerCase(),r=a.indexOf(s);if(-1===r)return null;let n=Math.max(0,r-50),l=Math.min(e.length,r+t.length+100),o=e.substring(n,l).trim();return n>0&&(o="..."+o),l<e.length&&(o+="..."),o},C=(e,t)=>t.trim()?e.split(RegExp("(".concat(t,")"),"gi")).map((e,a)=>e.toLowerCase()===t.toLowerCase()?(0,s.jsx)("span",{className:"text-xiaomi-orange font-semibold",children:e},a):e):e,L=t.filter(e=>{let t=""===d||e.title.toLowerCase().includes(d.toLowerCase())||e.excerpt.toLowerCase().includes(d.toLowerCase())||e.content.toLowerCase().includes(d.toLowerCase())||e.category.toLowerCase().includes(d.toLowerCase())||e.tags.some(e=>e.toLowerCase().includes(d.toLowerCase())),a=!h||e.category===h,s=!u||e.tags.includes(u),r=!b||(()=>{let t=new Date(e.date);return"".concat(t.getFullYear(),"-").concat(String(t.getMonth()+1).padStart(2,"0"))===b})();return t&&a&&s&&r}).map(e=>{let t=e.excerpt,a=!1,s="";if(d){let r=e.title.toLowerCase().includes(d.toLowerCase()),n=e.excerpt.toLowerCase().includes(d.toLowerCase()),l=e.category.toLowerCase().includes(d.toLowerCase()),o=e.tags.some(e=>e.toLowerCase().includes(d.toLowerCase()));if(!r&&!n){if(l)s="匹配分类";else if(o){let t=e.tags.filter(e=>e.toLowerCase().includes(d.toLowerCase()));s="匹配标签: ".concat(t.join(", "))}else{let s=N(e.content,d);s&&(t=s,a=!0)}}}return{...e,snippet:t,isContentMatch:a,matchType:s}}),k=(e,t,a)=>{let s=new URLSearchParams;e&&s.set("category",e),t&&s.set("tag",t),a&&s.set("archive",a);let r=s.toString();x.push(r?"/blog?".concat(r):"/blog",{scroll:!1})},S=e=>{let t=h===e?null:e;g(t),k(t,u,b)},P=e=>{let t=u===e?null:e;p(t),k(h,t,b)},M=e=>{let t=b===e?null:e;f(t),k(h,u,t)};return(0,s.jsx)("article",{className:"min-h-screen bg-[#fafbfc] pt-14 pb-32",children:(0,s.jsxs)("div",{className:"max-w-[1400px] mx-auto px-6 lg:px-12",children:[(0,s.jsxs)("div",{className:"pt-12 md:pt-20 pb-8 md:pb-12 animate-fade-in",children:[(0,s.jsx)("h1",{className:"text-5xl sm:text-6xl font-black text-xiaomi-text mb-3 sm:mb-6 tracking-tight",children:"博客"}),(0,s.jsx)("p",{className:"text-xl text-gray-600 max-w-3xl",children:"探索技术世界，分享开发经验"})]}),(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6",children:[(0,s.jsxs)("div",{className:"lg:w-2/3",children:[(0,s.jsx)("div",{className:"mb-6 lg:hidden",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"text",value:d,onChange:e=>m(e.target.value),placeholder:"搜索文章...",className:"w-full px-4 py-3 bg-white border border-gray-200 focus:border-xiaomi-orange focus:outline-none focus:ring-1 focus:ring-xiaomi-orange text-sm"}),(0,s.jsx)("svg",{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})}),(d||h||u||b)&&(0,s.jsxs)("div",{className:"mb-6 p-4 bg-white border border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,s.jsx)("h4",{className:"text-sm font-semibold text-xiaomi-text",children:"当前筛选条件："}),(0,s.jsx)("button",{onClick:()=>{m(""),g(null),p(null),f(null),x.push("/blog",{scroll:!1})},className:"text-xs text-xiaomi-orange hover:text-xiaomi-orange-hover",children:"清除所有"})]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[d&&(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-white border border-gray-300 text-sm",children:["搜索: ",d,(0,s.jsx)("button",{onClick:()=>m(""),className:"ml-1 text-gray-400 hover:text-gray-600",children:"\xd7"})]}),h&&(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-white border border-gray-300 text-sm",children:["分类: ",h,(0,s.jsx)("button",{onClick:()=>S(h),className:"ml-1 text-gray-400 hover:text-gray-600",children:"\xd7"})]}),u&&(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-white border border-gray-300 text-sm",children:["标签: #",u,(0,s.jsx)("button",{onClick:()=>P(u),className:"ml-1 text-gray-400 hover:text-gray-600",children:"\xd7"})]}),b&&(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-white border border-gray-300 text-sm",children:["归档: ",b,(0,s.jsx)("button",{onClick:()=>M(b),className:"ml-1 text-gray-400 hover:text-gray-600",children:"\xd7"})]})]})]}),(0,s.jsx)("div",{className:"space-y-6",children:L.map((e,t)=>(0,s.jsxs)("article",{className:"bg-white border border-gray-200 p-6 hover:shadow-lg hover:border-xiaomi-orange/30 transition-all duration-300 group animate-slide-up",style:{animationDelay:"".concat(50*t,"ms")},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-4 mb-3 flex-wrap",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:[(0,s.jsx)("time",{dateTime:e.date,children:e.date}),(0,s.jsxs)("button",{onClick:t=>{t.preventDefault(),S(e.category)},className:"font-medium transition-all px-2 py-0.5 text-xs inline-flex items-center gap-1 ".concat("匹配分类"===e.matchType||h===e.category?"bg-xiaomi-orange text-white":"text-xiaomi-orange hover:bg-xiaomi-orange/10"),children:[(0,s.jsx)("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 1024 1024",children:(0,s.jsx)("path",{d:"M132.266667 810.666667h759.466666a4.266667 4.266667 0 0 0 4.266667-4.266667V345.6a4.266667 4.266667 0 0 0-4.266667-4.266667h-335.36a3.925333 3.925333 0 0 1-2.986666-1.28l-125.44-125.44A4.224 4.224 0 0 0 424.96 213.333333H132.266667a4.266667 4.266667 0 0 0-4.266667 4.266667v588.8a4.266667 4.266667 0 0 0 4.266667 4.266667z"})}),e.category]})]}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:e.tags.slice(0,3).map(e=>{let t=d&&e.toLowerCase()===d.toLowerCase(),a=d&&e.toLowerCase().includes(d.toLowerCase());return(0,s.jsxs)("button",{onClick:t=>{t.preventDefault(),P(e)},className:"px-2 py-0.5 text-xs transition-colors ".concat(t||u===e?"bg-xiaomi-orange text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:["#",a&&!t?C(e,d):e]},e)})})]}),(0,s.jsx)("h2",{className:"text-xl font-bold text-xiaomi-text mb-2 group-hover:text-xiaomi-orange transition-colors leading-tight",children:(0,s.jsx)(r.default,{href:"/blog/".concat(e.hash),children:d?C(e.title,d):e.title})}),(0,s.jsx)("p",{className:"text-gray-600 text-sm line-clamp-2 leading-relaxed",children:d?C(e.snippet,d):e.snippet})]},e.slug))}),0===L.length&&(0,s.jsx)("div",{className:"text-center py-12 text-gray-500",children:"没有找到匹配的文章"})]}),(0,s.jsx)("aside",{className:"hidden lg:block lg:w-1/3",children:(0,s.jsxs)("div",{className:"sticky top-24 space-y-6",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"text",value:d,onChange:e=>m(e.target.value),placeholder:"搜索文章...",className:"w-full px-4 py-3 bg-white border border-gray-200 focus:border-xiaomi-orange focus:outline-none focus:ring-1 focus:ring-xiaomi-orange text-sm"}),(0,s.jsx)("svg",{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),(0,s.jsxs)("div",{className:"bg-white border border-gray-200 p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-xiaomi-text mb-4",children:"分类"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"grid grid-cols-3 gap-2 ".concat(y?"":"max-h-[120px] overflow-hidden"),children:a.map(e=>{let a=t.filter(t=>t.category===e).length;return(0,s.jsxs)("button",{onClick:()=>S(e),className:"flex items-center justify-between px-2 py-1.5 text-sm transition-colors ".concat(h===e?"bg-xiaomi-orange text-white":"hover:bg-gray-100 text-gray-700"),title:e,children:[(0,s.jsx)("span",{className:"truncate",children:e}),(0,s.jsxs)("span",{className:"ml-1 flex-shrink-0 text-xs ".concat(h===e?"text-white/80":"text-gray-400"),children:["(",a,")"]})]},e)})}),!y&&a.length>6&&(0,s.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-12 bg-gradient-to-t from-white to-transparent pointer-events-none"})]}),a.length>6&&(0,s.jsx)("button",{onClick:()=>w(!y),className:"w-full text-center text-xs text-xiaomi-orange hover:text-xiaomi-orange-hover mt-1 py-1",children:y?"收起 ▲":"展开更多 ▼"})]}),(0,s.jsxs)("div",{className:"bg-white border border-gray-200 p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-xiaomi-text mb-4",children:"标签"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:o.map(e=>{let a=t.filter(t=>t.tags.includes(e)).length,r=u===e;return(0,s.jsxs)("button",{onClick:()=>P(e),className:"px-3 py-1 text-xs cursor-pointer transition-colors ".concat(r?"bg-xiaomi-orange text-white":"bg-gray-100 hover:bg-xiaomi-orange hover:text-white text-gray-700"),title:"".concat(a," 篇文章"),children:["#",e]},e)})})]}),(0,s.jsxs)("div",{className:"bg-white border border-gray-200 p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-xiaomi-text mb-4",children:"归档"}),(0,s.jsx)("div",{className:"space-y-3",children:i.map(e=>{let t=j.has(e.year),a=["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],r=new Map(e.months.map(e=>{let[,t]=e.month.split("-");return[parseInt(t),e]})),n=Array.from({length:12},(t,s)=>{let n=s+1,l=r.get(n);return{monthKey:(null==l?void 0:l.month)||"".concat(e.year,"-").concat(String(n).padStart(2,"0")),monthName:a[s],count:(null==l?void 0:l.count)||0,hasData:!!l}});return(0,s.jsxs)("div",{children:[(0,s.jsxs)("button",{onClick:()=>{let a=new Set(j);t?a.delete(e.year):a.add(e.year),v(a)},className:"w-full flex justify-between items-center px-3 py-2 hover:bg-gray-100 text-gray-700 transition-colors text-sm font-medium",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("svg",{className:"w-3 h-3 transition-transform ".concat(t?"rotate-90":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),(0,s.jsxs)("span",{children:[e.year,"年"]})]}),(0,s.jsxs)("span",{className:"text-xs text-gray-400",children:["(",e.count,")"]})]}),t&&(0,s.jsx)("div",{className:"grid grid-cols-3 gap-1.5 mt-2 px-1",children:n.map(e=>{let t=b===e.monthKey,a=e.hasData;return(0,s.jsxs)("button",{onClick:()=>a&&M(e.monthKey),disabled:!a,className:"flex items-center justify-between px-2 py-1.5 text-xs transition-colors ".concat(t?"bg-xiaomi-orange text-white":a?"bg-gray-50 hover:bg-gray-100 text-gray-700":"bg-white text-gray-300 cursor-not-allowed"),title:a?"".concat(e.count," 篇文章"):"无文章",children:[(0,s.jsx)("span",{children:e.monthName}),(0,s.jsxs)("span",{className:"text-xs ".concat(t?"text-white/70":a?"text-gray-400":"text-gray-300"),children:["(",e.count,")"]})]},e.monthKey)})})]},e.year)})})]})]})})]})]})})}},7648:function(e,t,a){"use strict";a.d(t,{default:function(){return r.a}});var s=a(2972),r=a.n(s)},9376:function(e,t,a){"use strict";var s=a(5475);a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})}},function(e){e.O(0,[972,971,117,744],function(){return e(e.s=4730)}),_N_E=e.O()}]);